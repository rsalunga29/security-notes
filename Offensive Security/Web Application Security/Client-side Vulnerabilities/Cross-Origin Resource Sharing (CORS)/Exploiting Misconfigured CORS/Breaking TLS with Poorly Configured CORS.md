In a situation where an application that employs HTTPS also whitelists a trusted subdomain that is using plain HTTP. An attacker can intercept a victim's user traffic and exploit the CORS configuration to compromise the victim's interaction with the application.

For example, the following request is sent:
```http
GET /api/requestApiKey HTTP/1.1
Host: vulnerable-website.com
Origin: http://trusted-subdomain.vulnerable-website.com
Cookie: sessionid=...
```
And the application responds with:
```http
HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://trusted-subdomain.vulnerable-website.com
Access-Control-Allow-Credentials: true
```
An attacker can follow the following steps to conduct the exploitation:
1. The victim user makes any plain HTTP request.
2. The attacker injects a redirection to `http://trusted-subdomain.vulnerable-website.com`.
3. The victim's browser follows the redirect.
4. The attacker intercepts the plain HTTP request, and returns a spoofed response containing a CORS request to: `https://vulnerable-website.com`.
5. The victim's browser makes the CORS request, including the origin: `http://trusted-subdomain.vulnerable-website.com`.
6. The application allows the request because this is a whitelisted origin. The requested sensitive data is returned in the response.
7. The attacker's spoofed page can read the sensitive data and transmit it to any domain under the attacker's control.

 This attack is effective even if the vulnerable website is otherwise robust in its usage of HTTPS, with no HTTP endpoint and all cookies flagged as secure. 