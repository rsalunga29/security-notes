There will be times where we will be needing to construct a custom payload to exploit SSTI vulnerabilities. For example, a template engine that executes templates inside a sandbox, which can make exploitation difficult or impossible.

In the following example, a web application allows us to edit production description templates, which uses the Freemarker template engine. We notice that we have access to the `product` object.

We then load up JavaDoc to see which `Object` class methods are available on all objects. To confirm this, we execute `${product.getClass()}`.

Explore the documentation to find a sequence of method invocation that allows us to escape the sandbox and let's us arbitrarily read system files. For example:
```java
${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/etc/passwd').toURL().openStream().readAllBytes()?join(" ")}
```
The code above will return the contents of the file as decimal ASCII. We can use a bytes-to-ASCII converter to read the contents.