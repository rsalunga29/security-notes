After detecting that a potential vulnerability exists and successfully identifying the template engine, we can start exploiting it:
## Read the Documentation
First step to do is to go through the templating engine documentation and learn the basic syntax, along with key functions and handling of variables. For example, if we know that the Python-based Mako template is being used, we can achieve remote code execution using the following basic payload:
```python
<%
	import os
	x=os.popen('id').read()
	%>

	${x}
```
In an non-sandboxed environment, achieving remote code execution and using it to read, edit, or delete arbitrary files is similarly as simple in many common template engines.
### Security Section
Additionally, the documentation also provides some sort of a security section, while the name may vary, it usually outlines all the potentially dangerous things that people should avoid doing with the template. This can be an invaluable resource, acting some kind of a cheat sheet for exploiting the template.

Even if there is no dedicated "Security" section, if a particular built-in object or function can pose a security risk, there is almost always a warning of some kind in the documentation. For example, in the ERB documentation, it reveals that you can list all the directories and read files as follows:
```html
<%= Dir.entries('/') %>
<%= File.open('/etc/passwd').read() %>
```
## Look for Known Exploits
Finally, if we already know the templating engine and its version, we can look for any existing exploits and use it.
## Explore Self or Environment Objects
Many template engines expose a "self" or "environment" object of some kind. If such an object exists, we can potentially use it to generate a list of objects that are in scope. For example, in Java-based templating engines, we can list all environment variables as follow:
```java
${T(java.lang.System).getenv()}
```
## Explore Developer-supplied Objects
It is important to note that websites will contain both built-in objects provided by the template and custom, site-specific objects that have been supplied by the developer.

For example, imagine a web application running in Django and is vulnerable to SSTI. Studying the documentation, we can see that Django templates has a built-in `debug` tag to display debugging information.

If we input `{% debug %}`, we can see that it outputs a list of objects and properties to which we have access from within the vulnerable template. Look for the `settings` object.

Looking into the [settings object documentation](https://docs.djangoproject.com/en/5.0/ref/settings/), we can see that it contains a `SECRET_KEY` property, which has dangerous security implications if known to us (attacker). To get this value, all we have to do is enter the expression `{{settings.SECRET_KEY}}`, leading to a SSTI chained Information Disclosure.